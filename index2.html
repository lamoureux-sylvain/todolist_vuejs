<!DOCTYPE html>
<html lang="en" xmlns:v-on="http://www.w3.org/1999/xhtml" xmlns:v-bind="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport">
    <script src="vue2.3.3.js"></script>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <title>Lifecycle hooks</title>
</head>

<body>
<h1>Lifecycle hooks</h1>

<div id="app">

    <hr>
    <my-card>
        <h2 slot="cardheader">Blog vue JS</h2>
        <div slot="cardbody">visitez meanjs.fr</div>
    </my-card>
    <hr>

    <h3>Utilisateurs</h3>

    <ul>
        <user-list v-bind:data ="users" v-bind:users-coming="usersComing"></user-list>
    </ul>
    <div v-for="user in usersComing">
        {{user.email}} - {{users.username}}
    </div>
</div>

<script>
    Vue.component('my-card', {
        template: '<div><slot name="cardheader"> titre par défaut </slot><slot name="cardbody"> contenu par défaut </slot></div>'
    });

    Vue.component('user-list',{
        template: '<div><ul><li v-for="user in data"><user-details v-bind:usr="user" v-on:accept="registerUser(user)"></user-details></li></ul></div>',
        props: ['data', 'usersComing'],
        methods: {
            registerUser: function(user) {
                this.usersComing.push(user);
            }
        }
    });

    Vue.component('user-details',{
        template: '<div>nom: {{usr.username}}, ville: {{usr.address.city}}, email: {{usr.email}}<button v-on:click="acceptInvitation">accepter</button></div>',
        props: ['usr'],
        methods: {
            acceptInvitation: function() {
                this.$emit('accept');
            }
        }
    });

    var vm = new Vue({
        el: '#app',
        data: {
            title: 'Lifecycle hooks',
            usersUrl: 'https://jsonplaceholder.typicode.com/users',
            users: [],
            usersComing: []
        },
        created: function() {
            axios.get(this.usersUrl)
                 .then(function(response) {
                     vm.users = response.data;
                 })
        }
    });
</script>
</body>
</html>